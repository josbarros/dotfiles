#!/bin/sh

echo "Waiting for the user to get an SSH key from an external hardware key"
cd ~/.ssh
while true; do
    ssh-keygen -K 	
    if ssh-add -L > /dev/null 2>&1; then
        echo "SSH key(s) are loaded!"
        break
    fi
done
cd -

# Install yadm in a Fedora system and clone the dotfiles repo
sudo dnf config-manager addrepo --from-repofile=https://download.opensuse.org/repositories/home:TheLocehiliosan:yadm/Fedora_42/home:TheLocehiliosan:yadm.repo
sudo dnf install -y yadm

yadm clone git@github.com:josbarros/dotfiles.git
yadm gitconfig user.email "joserui@joseruibarros.com"
yadm gitconfig user.name "Jos√© Rui Barros"
