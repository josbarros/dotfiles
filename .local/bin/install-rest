#!/bin/sh

# Install everything
sudo dnf config-manager setopt rpmfusion-nonfree-steam.enabled=1
sudo dnf install -y gnome-tweaks gnome-extensions-app ranger alacritty zsh thunderbird steam gnupg2-scdaemon

sudo flatpak remote-modify --enable flathub
flatpak install -y flathub org.signal.Signal com.discordapp.Discord com.yubico.yubioath

# Configure Zsh
if [ "$SHELL" != "$(which zsh)" ]; then
  chsh -s $(which zsh)
  echo "Shell changed to zsh."
else
  echo "You are already using zsh."
fi

ZINIT_HOME="$XDG_DATA_HOME/zinit"
bash -c "$(curl --fail --show-error --silent --location https://raw.githubusercontent.com/zdharma-continuum/zinit/HEAD/scripts/install.sh)"

# zsh -c 'zinit self-update'

# Configure Vim
curl -fLo "$XDG_CONFIG_HOME/vim/autoload/plug.vim" --create-dirs https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
mkdir -p "$XDG_CACHE_HOME/vim/swap" "$XDG_CACHE_HOME/vim/backup"

# Install nvm
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.3/install.sh | bash
source ~/.zprofile
[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"  # This loads nvm
nvm install --lts

# GPG Stuff
sudo dnf remove -y opensc
sudo systemctl enable pcscd.socket pcscd.service
sudo systemctl start pcscd.socket pcscd.service
gpg --import "$XDG_DATA_HOME/public.asc"
